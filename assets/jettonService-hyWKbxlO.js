import{ef as F,eg as $,eh as z,ei as X,ej as k,ek as Z,el as R,em as b,en as j,dp as M,dq as p,a2 as o,dy as x,dt as T,eo as w,ep as h,Y as A,dm as S,dn as I,a5 as O,dx as L,dw as q,du as N,eq as W,er as v,dr as f}from"./index-z3CvngUh.js";function _(e){return e==null?e:{boc:e.boc}}function ee(e){return te(e)}function te(e,t){return e==null?e:{boc:e.boc,decodedOpName:e.decoded_op_name==null?void 0:e.decoded_op_name,opCode:e.op_code==null?void 0:e.op_code,decodedBody:e.decoded_body==null?void 0:e.decoded_body}}function B(e){return ne(e)}function ne(e,t){return e==null?e:{message:ee(e.message),mode:e.mode}}function se(e){return ae(e)}function ae(e,t){return e==null?e:{subwalletId:e.subwallet_id,boundedQueryId:e.bounded_query_id,rawMessages:e.raw_messages.map(B)}}function re(e){return oe(e)}function oe(e,t){return e==null?e:{subwalletId:e.subwallet_id,validUntil:e.valid_until,seqno:e.seqno,rawMessages:e.raw_messages.map(B)}}function de(e){return ce(e)}function ce(e,t){return e==null?e:{subwalletId:e.subwallet_id,validUntil:e.valid_until,seqno:e.seqno,op:e.op,rawMessages:e.raw_messages.map(B)}}function ue(e){return ie(e)}function ie(e,t){return e==null?e:{walletV3:e.wallet_v3==null?void 0:re(e.wallet_v3),walletV4:e.wallet_v4==null?void 0:de(e.wallet_v4),walletHighloadV2:e.wallet_highload_v2==null?void 0:se(e.wallet_highload_v2)}}function le(e){return ge(e)}function ge(e,t){return e==null?e:{destination:F(e.destination),destinationWalletVersion:e.destination_wallet_version,extInMsgDecoded:e.ext_in_msg_decoded==null?void 0:ue(e.ext_in_msg_decoded)}}function me(e){return e==null?e:{address:e.address,balance:e.balance}}function fe(e){return e==null?e:{boc:e.boc,params:e.params==null?void 0:e.params.map(me)}}function we(e){return Ae(e)}function Ae(e,t){return e==null?e:{quantity:e.quantity,walletAddress:F(e.wallet_address),jetton:$(e.jetton)}}function ye(e){return Re(e)}function Re(e,t){return e==null?e:{transferAllRemainingBalance:e.transfer_all_remaining_balance,ton:e.ton,jettons:e.jettons.map(we),nfts:e.nfts.map(z)}}function D(e){return Me(e)}function Me(e,t){return e==null?e:{transaction:X(e.transaction),interfaces:e.interfaces,children:e.children==null?void 0:e.children.map(D),emulated:e.emulated==null?void 0:e.emulated}}function pe(e){return Te(e)}function Te(e,t){return e==null?e:{trace:D(e.trace),risk:ye(e.risk),event:k(e.event)}}class P extends Z{async decodeMessageRaw(t,n){if(t.decodeMessageRequest==null)throw new R("decodeMessageRequest",'Required parameter "decodeMessageRequest" was null or undefined when calling decodeMessage().');const s={},a={};a["Content-Type"]="application/json";const r=await this.request({path:"/v2/message/decode",method:"POST",headers:a,query:s,body:_(t.decodeMessageRequest)},n);return new b(r,d=>le(d))}async decodeMessage(t,n){return await(await this.decodeMessageRaw(t,n)).value()}async emulateMessageToAccountEventRaw(t,n){if(t.accountId==null)throw new R("accountId",'Required parameter "accountId" was null or undefined when calling emulateMessageToAccountEvent().');if(t.decodeMessageRequest==null)throw new R("decodeMessageRequest",'Required parameter "decodeMessageRequest" was null or undefined when calling emulateMessageToAccountEvent().');const s={};t.ignoreSignatureCheck!=null&&(s.ignore_signature_check=t.ignoreSignatureCheck);const a={};a["Content-Type"]="application/json",t.acceptLanguage!=null&&(a["Accept-Language"]=String(t.acceptLanguage));const r=await this.request({path:"/v2/accounts/{account_id}/events/emulate".replace("{account_id}",encodeURIComponent(String(t.accountId))),method:"POST",headers:a,query:s,body:_(t.decodeMessageRequest)},n);return new b(r,d=>k(d))}async emulateMessageToAccountEvent(t,n){return await(await this.emulateMessageToAccountEventRaw(t,n)).value()}async emulateMessageToEventRaw(t,n){if(t.decodeMessageRequest==null)throw new R("decodeMessageRequest",'Required parameter "decodeMessageRequest" was null or undefined when calling emulateMessageToEvent().');const s={};t.ignoreSignatureCheck!=null&&(s.ignore_signature_check=t.ignoreSignatureCheck);const a={};a["Content-Type"]="application/json",t.acceptLanguage!=null&&(a["Accept-Language"]=String(t.acceptLanguage));const r=await this.request({path:"/v2/events/emulate",method:"POST",headers:a,query:s,body:_(t.decodeMessageRequest)},n);return new b(r,d=>j(d))}async emulateMessageToEvent(t,n){return await(await this.emulateMessageToEventRaw(t,n)).value()}async emulateMessageToTraceRaw(t,n){if(t.decodeMessageRequest==null)throw new R("decodeMessageRequest",'Required parameter "decodeMessageRequest" was null or undefined when calling emulateMessageToTrace().');const s={};t.ignoreSignatureCheck!=null&&(s.ignore_signature_check=t.ignoreSignatureCheck);const a={};a["Content-Type"]="application/json";const r=await this.request({path:"/v2/traces/emulate",method:"POST",headers:a,query:s,body:_(t.decodeMessageRequest)},n);return new b(r,d=>D(d))}async emulateMessageToTrace(t,n){return await(await this.emulateMessageToTraceRaw(t,n)).value()}async emulateMessageToWalletRaw(t,n){if(t.emulateMessageToWalletRequest==null)throw new R("emulateMessageToWalletRequest",'Required parameter "emulateMessageToWalletRequest" was null or undefined when calling emulateMessageToWallet().');const s={},a={};a["Content-Type"]="application/json",t.acceptLanguage!=null&&(a["Accept-Language"]=String(t.acceptLanguage));const r=await this.request({path:"/v2/wallet/emulate",method:"POST",headers:a,query:s,body:fe(t.emulateMessageToWalletRequest)},n);return new b(r,d=>pe(d))}async emulateMessageToWallet(t,n){return await(await this.emulateMessageToWalletRaw(t,n)).value()}}const Ee=async(e,t,n,s,a,r,d)=>{const u=n.auth.info,c=M(n),i=g=>d(g,"transaction",u),l=await c.createTransferAndSignRequestAsync({seqno:t,signer:i,timeout:p(e),sendMode:r?o.SendMode.CARRY_ALL_REMAINING_BALANCE+o.SendMode.IGNORE_ERRORS:o.SendMode.PAY_GAS_SEPARATELY+o.SendMode.IGNORE_ERRORS,messages:[o.internal({to:o.Address.parse(s.toAccount.address),bounce:x(s.toAccount,s.address),value:BigInt(a.toFixed(0)),body:s.comment!==""?s.comment:void 0})]});return T(c,t,l).toBoc()},he=async(e,t,n,s,a,r,d,u)=>{const c=n.auth.info,i=g=>u(g,"transaction",c),l=G({queryId:w(),newOwnerAddress:o.Address.parse(s),responseAddress:o.Address.parse(n.active.rawAddress),forwardAmount:J,forwardPayload:d});return h({timestamp:e,seqno:t,state:n,signer:i},{to:a,value:r,body:l})},Se=async(e,t,n,s,a,r,d,u)=>{const c=BigInt(a.stringWeiAmount),i=n.auth.info,l=H=>u(H,"transaction",i),g=K({queryId:w(),jettonAmount:c,toAddress:o.Address.parse(s),responseAddress:o.Address.parse(n.active.rawAddress),forwardAmount:C,forwardPayload:d}),m=M(n),y=await m.createTransferAndSignRequestAsync({seqno:t,signer:l,timeout:p(e),sendMode:o.SendMode.PAY_GAS_SEPARATELY+o.SendMode.IGNORE_ERRORS,messages:[o.internal({to:o.Address.parse(r),bounce:!0,value:E,body:g})]});return T(m,t,y).toBoc()},be=o.toNano("1"),J=BigInt("1"),G=e=>o.beginCell().storeUint(1607220500,32).storeUint(e.queryId,64).storeAddress(e.newOwnerAddress).storeAddress(e.responseAddress).storeBit(!1).storeCoins(e.forwardAmount).storeMaybeRef(e.forwardPayload).endCell(),U=e=>o.beginCell().storeUint(1320284409,32).storeUint(e.queryId,64).storeUint(0,256).endCell(),_e=e=>o.beginCell().storeUint(40915,16).storeAddress(o.Address.parse(e)).storeUint(0,8),V=e=>{let t=o.beginCell().storeUint(1320284409,32).storeUint(e==null?void 0:e.queryId,64).storeUint(BigInt("0xe8d44050873dba865aa7c170ab4cce64d90839a34dcfd6cf71d14e0205443b1b"),256);return e.linkToAddress&&(t=t.storeRef(_e(e.linkToAddress))),t.endCell()},Y=(e,t,n,s,a,r,d,u)=>{const c=G({queryId:w(),newOwnerAddress:o.Address.parse(s),responseAddress:o.Address.parse(n.active.rawAddress),forwardAmount:J,forwardPayload:d});return h({timestamp:e,seqno:t,state:n,signer:u},{to:a,value:r,body:c})},Oe=async(e,t,n,s)=>{const a=await A(e),[r,d]=await S(e,t);I(r);const u=await Y(a,d,t,n.toAccount.address,s.address,be,n.comment?o.comment(n.comment):null,N);return{event:await new P(e.tonApiV2).emulateMessageToAccountEvent({ignoreSignatureCheck:!0,accountId:r.address,decodeMessageRequest:{boc:u.toString("base64")}})}},ve=async(e,t,n,s,a,r)=>{const d=await A(e),u=o.toNano("0.05").toString();let c=new O(a.event.extra).multipliedBy(-1).plus(u);c=c.isLessThan(u)?new O(u):c;const i=c.plus(a.event.extra*-1);if(c.isLessThanOrEqualTo(0))throw new Error(`Unexpected nft transfer amount: ${c.toString()}`);const[l,g]=await S(e,t);L(i,l);const m=[d,g,t,n.toAccount.address,s.address,BigInt(c.toString()),n.comment?o.comment(n.comment):null];let y;r.type==="ledger"?y=await qe(...m,r):r.type==="cell"?y=await Y(...m,r):y=await he(...m,r),await new q(e.tonApiV2).sendBlockchainMessage({sendBlockchainMessageRequest:{boc:y.toString("base64")}})},Be=async e=>{const t=await A(e.api),{seqno:n}=await W(e),s=U({queryId:w()}),a=await h({timestamp:t,seqno:n,state:e.walletState,signer:e.signer},{to:e.nftAddress,value:e.amount,body:s});await new q(e.api.tonApiV2).sendBlockchainMessage({sendBlockchainMessageRequest:{boc:a.toString("base64")}})},De=async e=>{const t=await A(e.api),[n,s]=await S(e.api,e.walletState);I(n);const a=U({queryId:w()});return(await h({timestamp:t,seqno:s,state:e.walletState,signer:N},{to:e.nftAddress,value:e.amount,body:a})).toString("base64")},Je=async e=>{const t=await A(e.api),{seqno:n}=await W(e),s=V({...e,queryId:w()}),a=await h({timestamp:t,seqno:n,state:e.walletState,signer:e.signer},{to:e.nftAddress,value:e.amount,body:s});await new q(e.api.tonApiV2).sendBlockchainMessage({sendBlockchainMessageRequest:{boc:a.toString("base64")}})},Ce=async e=>{const t=await A(e.api),[n,s]=await S(e.api,e.walletState);I(n);const a=V({...e,queryId:w()});return(await h({timestamp:t,seqno:s,state:e.walletState,signer:N},{to:e.nftAddress,value:e.amount,body:a})).toString("base64")},Fe=async(e,t,n,s,a,r,d)=>{const u=v(n.auth.accountIndex),c=M(n),i=await d(u,{to:o.Address.parse(s.toAccount.address),bounce:x(s.toAccount,s.address),amount:BigInt(a.toFixed(0)),seqno:t,timeout:p(e),sendMode:r?f.CARRY_ALL_REMAINING_BALANCE+f.IGNORE_ERRORS:f.PAY_GAS_SEPARATELY+f.IGNORE_ERRORS,payload:s.comment!==""?{type:"comment",text:s.comment}:void 0});return T(c,t,i).toBoc()},Ie=async(e,t,n,s,a,r,d,u)=>{const c=BigInt(a.stringWeiAmount),i=v(n.auth.accountIndex),l=M(n),g=await u(i,{to:o.Address.parse(r),bounce:!0,amount:E,seqno:t,timeout:p(e),sendMode:f.PAY_GAS_SEPARATELY+f.IGNORE_ERRORS,payload:{type:"jetton-transfer",queryId:w(),amount:c,destination:o.Address.parse(s),responseDestination:o.Address.parse(n.active.rawAddress),forwardAmount:C,forwardPayload:d,customPayload:null}});return T(l,t,g).toBoc()},qe=async(e,t,n,s,a,r,d,u)=>{const c=v(n.auth.accountIndex),i=M(n),l=await u(c,{to:o.Address.parse(a),bounce:!0,amount:r,seqno:t,timeout:p(e),sendMode:f.PAY_GAS_SEPARATELY+f.IGNORE_ERRORS,payload:{type:"nft-transfer",queryId:w(),newOwner:o.Address.parse(s),responseDestination:o.Address.parse(n.active.rawAddress),forwardAmount:J,forwardPayload:d,customPayload:null}});return T(i,t,l).toBoc()},E=o.toNano(.1),C=BigInt(1),K=e=>o.beginCell().storeUint(260734629,32).storeUint(e.queryId,64).storeCoins(e.jettonAmount).storeAddress(e.toAddress).storeAddress(e.responseAddress).storeBit(!1).storeCoins(e.forwardAmount).storeMaybeRef(e.forwardPayload).endCell(),Q=async(e,t,n,s,a,r,d,u)=>{const c=BigInt(a.stringWeiAmount),i=K({queryId:w(),jettonAmount:c,toAddress:o.Address.parse(s),responseAddress:o.Address.parse(n.active.rawAddress),forwardAmount:C,forwardPayload:d}),l=M(n),g=await l.createTransferAndSignRequestAsync({seqno:t,signer:u,timeout:p(e),sendMode:f.PAY_GAS_SEPARATELY+f.IGNORE_ERRORS,messages:[o.internal({to:o.Address.parse(r),bounce:!0,value:E,body:i})]});return T(l,t,g).toBoc()},ke=async(e,t,n,s,a)=>{const r=await A(e),[d,u]=await S(e,t);I(d);const c=await Q(r,u,t,n.toAccount.address,s,a,n.comment?o.comment(n.comment):null,N);return{event:await new P(e.tonApiV2).emulateMessageToAccountEvent({ignoreSignatureCheck:!0,accountId:d.address,decodeMessageRequest:{boc:c.toString("base64")}})}},xe=async(e,t,n,s,a,r,d)=>{const u=await A(e),c=new O(r.event.extra).multipliedBy(-1).plus(E.toString()),[i,l]=await S(e,t);L(c,i);let g;const m=[u,l,t,n.toAccount.address,s,a,n.comment?o.comment(n.comment):null];d.type==="ledger"?g=await Ie(...m,d):d.type==="cell"?g=await Q(...m,d):g=await Se(...m,d),await new q(e.tonApiV2).sendBlockchainMessage({sendBlockchainMessageRequest:{boc:g.toString("base64")}})};export{P as E,Ee as a,Ce as b,Fe as c,Je as d,ke as e,De as f,Be as g,Oe as h,ve as i,xe as s};
